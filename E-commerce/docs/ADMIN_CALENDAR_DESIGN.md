# 管理人員行事曆設計概念

## 概述
整合商品上下架時間和行銷活動期間的管理行事曆系統，讓管理人員能夠直觀地調整和監控時間安排。

---

## 1. 核心功能模組

### 時間軸視圖
- **月視圖/週視圖/日視圖** - 多維度展示商品與活動時間安排
- **拖拽調整** - 直接在行事曆上拖動商品/活動時間段進行時間調整
- **顏色編碼系統** - 區分商品上下架、活動期間、促銷活動等

### 事件類型
- 🟦 **商品上架/下架時間** - 展示商品何時上線及下線
- 🟩 **行銷活動期間** - 展示促銷、限時優惠等活動
- 🟨 **特殊活動** - 新品發佈、清倉等特殊事件
- 🟪 **訂單相關截止日期** - 訂單截止、發貨截止等重要日期

---

## 2. 時間衝突檢測

### 警示機制
- 檢測商品下架時間與進行中活動衝突
- 提醒活動期間內商品不足的情況
- 提示已過期的商品或活動

### 關聯檢查
- 活動變更時自動提醒相關商品的狀態影響
- 商品下架時提醒正在進行的相關活動

### 驗證規則
- 確保上架時間早於下架時間
- 驗證活動開始時間早於結束時間
- 檢查活動期間商品是否已上架

---

## 3. 互動功能

### 批量操作
- 選取多個商品同時調整上下架時間
- 一鍵延長/縮短活動期間
- 批量應用時間變更至相關商品

### 快速編輯
- 點擊事件卡片快速編輯詳細資訊
- 行內編輯時間欄位
- 雙擊直接修改時間

### 篩選與搜尋
- 按商品分類、活動類型、時間段篩選
- 搜尋特定商品名稱或活動名稱
- 按狀態篩選（即將開始、進行中、已結束）

---

## 4. 資料整合展示

```
行事曆中應展示：
├─ 商品基本資訊
│   ├─ 名稱
│   ├─ SKU
│   └─ 庫存
├─ 上下架時間段
├─ 關聯的行銷活動
├─ 預期銷售影響
└─ 操作歷史記錄
```

### 詳細資訊面板
- 商品圖片縮圖
- 原價/促銷價
- 預期銷量預測
- 相關部門提醒（物流、財務等）

---

## 5. 預覽與模擬

### 時間模擬
- 預覽特定日期商品上下架的實際效果
- 模擬時間變更後的前端展示效果

### 庫存預測
- 根據活動期間估算庫存消耗
- 提示庫存不足的警告

### 衝突提示
- 實時提示可能的問題
- 提供修復建議

---

## 6. 資料結構建議

| 元素 | 包含內容 |
|------|--------|
| **商品事件** | 商品ID、上架時間、下架時間、狀態、庫存 |
| **活動事件** | 活動ID、開始時間、結束時間、適用商品清單、折扣信息 |
| **操作記錄** | 變更人員、變更時間、變更內容、原值→新值、操作備註 |

### 關聯關係
- 一個活動可關聯多個商品
- 一個商品可參與多個活動
- 支持活動層級（全站活動、分類活動、商品專場）

---

## 7. 使用者體驗優化

### 便利性
- 自動保存變更草稿
- 撤銷/重做功能
- 匯出行事曆（PDF、Excel）

### 權限與審核
- 團隊成員權限管理（檢視/編輯/審核）
- 變更審核流程（需要管理員確認）
- 操作日誌追蹤（誰、何時、做了什麼）

### 通知提醒
- 即將開始的活動提醒
- 商品即將下架提醒
- 審核待辦提醒

---

## 8. 技術實現建議

### 後端 API 端點
```
GET    /api/admin/calendar/events         - 獲取行事曆事件
GET    /api/admin/calendar/events/{id}    - 獲取事件詳情
POST   /api/admin/calendar/events         - 建立事件
PUT    /api/admin/calendar/events/{id}    - 更新事件
DELETE /api/admin/calendar/events/{id}    - 刪除事件
GET    /api/admin/calendar/conflicts      - 檢查時間衝突
GET    /api/admin/calendar/preview        - 預覽時間變更效果
POST   /api/admin/calendar/batch-update   - 批量更新
```

### 前端技術
- 行事曆組件：FullCalendar.js 或類似庫
- 拖拽功能：React DnD 或 Sortable.js
- 時間選擇：DatePicker 組件
- 圖表展示：圖表庫用於預測數據

### 資料庫結構
```sql
-- 行事曆事件表
CREATE TABLE calendar_events (
    id BIGINT PRIMARY KEY,
    type VARCHAR(50),           -- 'PRODUCT', 'ACTIVITY', 'SPECIAL'
    entity_id BIGINT,           -- 商品ID或活動ID
    entity_type VARCHAR(50),
    start_time DATETIME,
    end_time DATETIME,
    title VARCHAR(255),
    description TEXT,
    created_by BIGINT,
    created_at DATETIME,
    updated_by BIGINT,
    updated_at DATETIME
);

-- 活動商品關聯表
CREATE TABLE activity_products (
    id BIGINT PRIMARY KEY,
    activity_id BIGINT,
    product_id BIGINT,
    discount_rate DECIMAL(5,2),
    created_at DATETIME
);
```

---

## 9. 實現優先級

### Phase 1（基礎功能）
- [ ] 基本行事曆展示（月/週視圖）
- [ ] 商品上下架事件顯示
- [ ] 活動期間展示
- [ ] 簡單的時間衝突檢測

### Phase 2（進階功能）
- [ ] 拖拽調整時間
- [ ] 批量操作
- [ ] 詳細篩選和搜尋
- [ ] 操作歷史記錄

### Phase 3（優化功能）
- [ ] 庫存預測
- [ ] 時間模擬預覽
- [ ] 權限控制和審核流程
- [ ] 通知提醒系統

---

## 10. 使用場景示例

### 場景 1：活動規劃
管理員計畫舉辦"雙12購物節"，需要：
1. 在行事曆上建立活動事件（12/12 00:00 - 12/13 23:59）
2. 選擇參與商品，系統自動檢查商品是否已上架
3. 系統提醒需要確認庫存充足
4. 設置折扣信息和活動規則

### 場景 2：商品下架風險預警
系統檢測到：
- 商品 A 計畫在 12/15 下架
- 但購物節活動延續到 12/20
- 自動提醒：「商品 A 即將下架，將影響購物節活動」

### 場景 3：時間批量調整
黑色星期五活動從 11/28 調整到 12/5，管理員：
1. 在行事曆上點擊活動
2. 選擇「批量延期關聯商品」
3. 系統自動調整所有關聯商品的促銷時間

---

## 11. 成功指標

- ✅ 減少管理員手動檢查時間衝突的時間
- ✅ 降低因時間安排不當導致的商品缺貨
- ✅ 提高活動與商品配合的準確性
- ✅ 增強團隊協作效率
- ✅ 完整的操作審計追蹤

